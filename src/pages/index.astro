---
import { getCollection } from "astro:content";
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard.astro";
import Link from "@components/Link.astro";
import { dateRange } from "@lib/utils";
import { SITE, HOME, SOCIALS } from "@consts";
import { Icon } from "astro-icon/components";
import Confetti from "@components/Confetti.astro";

const blog = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_POSTS_ON_HOMEPAGE);

const projects = (await getCollection("projects"))
  .filter((project) => !project.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_PROJECTS_ON_HOMEPAGE);

const allwork = (await getCollection("work"))
  .sort(
    (a, b) =>
      new Date(b.data.dateStart).valueOf() -
      new Date(a.data.dateStart).valueOf()
  )
  .slice(0, SITE.NUM_WORKS_ON_HOMEPAGE);

const work = await Promise.all(
  allwork.map(async (item) => {
    const { Content } = await item.render();
    return { ...item, Content };
  })
);
---

<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <div class="chat chat-start animate">
      <div class="chat-bubble shadow-xl animate">
        <h1
          class="animate font-semibold font-bold bg-clip-text text-transparent bg-gradient-to-t from-zinc-200 to-zinc-50 text-6xl py-3 px-1"
        >
          Hi, I'm Andrea <span class="text-6xl text-black">ðŸ‘‹</span>
        </h1>
      </div>
    </div>
    <div class="chat chat-end">
      <ul class="menu menu-xs bg-base-200 chat-bubble mt-3 animate bg-gray-200 text-black flex flex-row flex-wrap">
      {[...SOCIALS, { NAME: SITE.EMAIL, HREF: `mailto:${SITE.EMAIL}`, ICON: 'carbon:email' }].map((SOCIAL) => (
        <li class="mr-2">
        <Link
          data-tip={`${SOCIAL.NAME}`}
          href={SOCIAL.HREF}
          external
          aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}
          tooltip
        >
          <Icon name={`${SOCIAL.ICON}`} />
        </Link>
        </li>
      ))}
      </ul>
    </div>
    <div class="space-y-16">
      <section>
        <article class="space-y-4">
          <p class="animate">
            A creative professional turned into code/tech enthusiast who's
            currently diving headfirst into the world of software development
            through an intensive bootcamp at <b>Headforwards Digital Academy</b> &
            <b>CodeInstitute.</b>
          </p>
          <p class="animate">
            My journey is pretty unique â€“ I've experience in game art (where I
            worked on projects for <b>SEGA and Kwalee</b>) and even managed virtual
            accounts at <b>Deliveroo</b>!
          </p>
          <p class="animate">
            Now, I'm embracing my artistic background and analytical mindset
            into building beautiful, functional code. When I'm not tackiling
            coding challenges, you'll find me experimenting with recipes in the
            kitchen, walking around Cornwall's breathtaking landscapes, or
            exploring narrative-driven video games for inspiration.
          </p>
        </article>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">Latest posts</h5>
          <Link href="/blog"> See all posts </Link>
        </div>
        <ul class="flex flex-col gap-4">
          {
            blog.map((post) => (
              <li>
                <ArrowCard entry={post} />
              </li>
            ))
          }
        </ul>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Work Experience
          </h5>
          <Link href="/work"> See all work </Link>
        </div>
        <ul class="flex flex-col space-y-4">
          {
            work.map((entry) => (
              <li>
                <div class="text-sm opacity-75">
                  {dateRange(entry.data.dateStart, entry.data.dateEnd)}
                </div>
                <div class="font-semibold text-black dark:text-white">
                  {entry.data.company}
                </div>
                <div class="text-sm opacity-75">{entry.data.role}</div>
                <article>
                  <entry.Content />
                </article>
              </li>
            ))
          }
        </ul>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Recent projects
          </h5>
          <Link href="/projects"> See all projects </Link>
        </div>
        <ul class="flex flex-col gap-4">
          {
            projects.map((project) => (
              <li>
                <ArrowCard entry={project} />
              </li>
            ))
          }
        </ul>
      </section>
      <section class="animate space-y-4">
        <div class="chat chat-start">
          <div class="indicator">
        <div class="chat-bubble animate bg-blue-600 text-white">
          <div class="indicator-item -pl-2"><Confetti /></div>
          <h5 class="font-semibold">
            Let's Connect!!
          </h5>
        </div>
          </div>
          <br />
          <div class="chat chat-start">
        <div class="chat-bubble mt-3 animate bg-blue-600">
          <article>
            <p class="text-white">
          If you want to get in touch with me about something or just to
          say hi, reach out on social media or send me an email.
            </p>
          </article>
        </div>
          </div>
        </div>
        <div class="chat chat-end">
          <ul
        class="menu menu-lg bg-base-200 chat-bubble mt-3 animate bg-gray-200 text-black flex flex-row flex-wrap"
          >
            {
              SOCIALS.map((SOCIAL) => (
                <li>
                  <Link
                    data-tip={`${SOCIAL.NAME}`}
                    href={SOCIAL.HREF}
                    external
                    aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}
                    tooltip
                  >
                    <Icon name={`${SOCIAL.ICON}`} />
                  </Link>
                </li>
              ))
            }
            <li>
              <Link
                data-tip={`${SITE.EMAIL}`}
                href={`mailto:${SITE.EMAIL}`}
                aria-label={`Email ${SITE.NAME}`}
                tooltip
              >
                <Icon name="carbon:email" />
              </Link>
            </li>
          </ul>
        </div>
      </section>
    </div>
  </Container>
</PageLayout>
